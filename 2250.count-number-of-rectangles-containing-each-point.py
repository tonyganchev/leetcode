#
# @lc app=leetcode id=2250 lang=python3
#
# [2250] Count Number of Rectangles Containing Each Point
#

# @lc code=start
from cmath import pi
from typing import List


def bisect(x, arr, begin = 0, end = None):
    if end is None:
        end = len(arr)
    pivot = (end + begin) // 2
    if arr[pivot] == x:
        return pivot
    if arr[pivot] < x:
        if pivot == end - 1:
            return None
        return bisect(x, arr, pivot + 1, end)
    if pivot == begin:
        return pivot
    r = bisect(x, arr, begin, pivot)
    return pivot if r is None else r


class SearchMap:
    def __init__(self):
        self._widths = None
        self.overlaps = {}

    @property
    def widths(self):
        if self._widths is None:
            self._widths = sorted(self.overlaps.keys())
        return self._widths
    
    def add_overlap(self, width):
        existing_overlap = 0
        for w in self.overlaps.keys():
            if w <= width:
                self.overlaps[w] += 1
            if w >= width:
                existing_overlap = max(existing_overlap, self.overlaps[w])
        if width not in self.overlaps:
            self.overlaps[width] = existing_overlap + 1


class Solution:
    def countRectangles(self, rectangles: List[List[int]], points: List[List[int]]) -> List[int]:
        unique_heights = sorted([x for x in set([h for _, h in rectangles])])
        # print(unique_heights)
        unique_widths = sorted([x for x in set([w for w, _ in rectangles])])
        # print(unique_widths)
        unique_rects = self.build_search_map(rectangles, unique_heights, unique_widths)

        # print(unique_rects)

        results = []
        for x, y in points:
            bh = bisect(y, unique_heights)
            bw = bisect(x, unique_rects[bh].widths)
            if bh is None or bw is None:
                results.append(0)
            else:
                results.append(unique_rects[bh].overlaps[unique_rects[bh].widths[bw]])
        
        return results

    def build_search_map(self, rectangles, unique_heights, unique_widths):
        unique_rects = [SearchMap() for _ in unique_heights]
        
        for rw, rh in rectangles:
            for hi in range(len(unique_heights)):
                h = unique_heights[hi]
                if h > rh:
                    break
                unique_rects[hi].add_overlap(rw)
        return unique_rects
        


# @lc code=end

from test_utils import run_test

method = bisect
# run_test(method, [0, [1, 5, 8]], 0)
# run_test(method, [1, [1, 5, 8]], 0)
# run_test(method, [3, [1, 5, 8]], 1)
# run_test(method, [5, [1, 5, 8]], 1)
# run_test(method, [7, [1, 5, 8]], 2)
# run_test(method, [8, [1, 5, 8]], 2)
# run_test(method, [9, [1, 5, 8]], None)


method = Solution().countRectangles
# run_test(method, [[[1,2],[2,3],[2,5]], [[2,1],[1,4]]], [2,1])
# run_test(method, [[[1,1],[2,2],[3,3]], [[1,3],[1,1]]], [1,3])
run_test(method, [[[7,1],[2,6],[1,4],[5,2],[10,3],[2,4],[5,9]], [[7,1],[2,6],[1,4],[5,2],[10,3],[2,4],[5,9]]], [1,0,4,1,0,0,0,1])
run_test(method,
    [
        [[7514,54],[3862,1],[6280,3],[1416,48],[8722,55],[9356,13],[5340,88],[1084,64],[1660,52],[3777,5],[7500,14],[9900,48],[8288,3],[6157,74],[7665,90],[86,97],[3140,85],[1714,63],[7840,36],[8228,18],[13,69],[6422,75],[2328,41],[1966,49],[5459,4],[4838,8],[2452,26],[9226,8],[3555,65],[5479,3],[1979,80],[8782,14],[8342,58],[260,19],[6979,19],[3516,16],[7821,49],[7164,36],[1252,72],[5896,44],[2085,29],[409,32],[1116,65],[8159,57],[3850,99],[4531,63],[4840,62],[5210,77],[1789,71],[8102,34],[743,93],[413,17],[7942,9],[5990,50],[7348,71],[1786,54],[1633,38],[8665,100],[8868,43],[4115,18],[5393,69],[6045,14],[234,61],[8958,37],[630,8],[4698,22],[3410,88],[1894,35],[7177,94],[3426,24],[5439,74],[913,80],[1681,79],[4483,41],[2485,52],[5967,4],[6168,9],[9634,91],[7753,59],[1430,1],[1962,98],[6743,83],[761,7],[4948,46],[9143,29],[75,61],[540,11],[4545,48],[3299,96],[123,82],[1711,30],[6109,8],[6454,47],[6999,98],[4484,75],[9264,44],[2093,71],[4710,43],[4563,24],[6664,98],[8024,94],[6688,99],[7188,23],[6605,68],[8122,50],[2524,53],[2306,22],[3638,42],[3201,49],[4288,19],[8865,13],[6424,85],[2890,31],[410,1],[9676,5],[2715,36],[2448,72],[6415,2],[3459,26],[798,21],[7484,80],[706,76],[2736,80],[8914,64],[1378,82],[6704,18],[6136,97],[3634,90],[39,6],[7366,28],[920,85],[5130,13],[4465,36],[3070,77],[524,63],[7485,50],[587,55],[3101,64],[8959,42],[3557,100],[4983,51],[7342,76],[7445,68],[6557,5],[3135,33],[9276,83],[6920,80],[7184,71],[2319,44],[9767,58],[7660,26],[8198,9],[5085,44],[312,23],[1317,30],[7229,37],[5247,49],[7926,89],[9178,62],[2239,85],[6889,80],[1208,85],[5422,7],[1418,54],[6904,13],[9392,52],[1029,44],[5779,23],[9916,70],[4951,54],[3256,7],[7768,24],[8949,82],[9338,19],[3079,16],[5114,7],[3588,46],[304,73],[3045,79],[1253,49],[9436,53],[8797,25],[8149,6],[5950,55],[5506,47],[7431,89],[7305,91],[3139,51],[5173,29],[4593,78],[6969,1],[4400,3],[5046,83],[1504,55],[6047,15],[9843,29],[594,7],[5567,49],[6039,69],[5157,23],[8022,24],[5888,51],[2970,82],[3617,54],[4360,95],[9522,77],[1254,23],[5917,11],[1269,13],[6242,59],[5798,54],[2661,49],[6761,9],[5156,64],[5899,90],[3640,64],[6477,67],[28,79],[8145,72],[635,86],[6222,79],[2476,36],[2848,15],[9194,22],[9413,42],[975,5],[1921,37],[1757,79],[6674,39],[6014,58],[9584,41],[6806,66],[3575,64],[5055,21],[4781,66],[5929,71],[3674,30],[7297,65],[4560,31],[3316,26],[3483,89],[6732,29],[3189,73],[3676,97],[4831,41],[6337,87],[9419,64],[4173,100],[666,93],[2197,44],[4409,31],[4810,29],[6125,29],[519,66],[18,36],[5747,54],[9115,32],[6824,54],[1679,86],[6642,62],[6724,19],[4818,26],[7684,78],[6295,55],[7363,85],[5861,81],[9614,45],[2917,81],[9267,67],[7512,94],[4464,61],[8439,57],[830,68],[109,52],[5624,32],[9410,71],[1778,38],[2081,2],[6283,64],[3879,70],[5024,81],[4392,37],[2619,28],[583,91],[7004,26],[6035,60],[1411,75],[3436,100],[8319,50],[4232,72],[9426,58],[5324,54],[4049,26],[5092,29],[7007,11],[5384,87],[4142,38],[2344,61],[1907,95],[1833,79],[697,98],[923,50],[3906,17],[4011,79],[3605,49],[6493,92],[9414,76],[1479,7],[9576,84],[3096,63],[2604,31],[357,84],[3418,83],[7245,46],[6158,45],[79,71],[2904,13],[2761,15],[510,35],[7294,47],[513,38],[9316,15],[9391,98],[2711,89],[7671,20],[6057,99],[9309,86],[9340,63],[9648,51],[8593,9],[9195,75],[2845,34],[6176,14],[9074,94],[7293,42],[7970,73],[8423,91],[7403,39],[9463,4],[4415,100],[3824,21],[4947,1],[3380,31],[1788,27],[4269,78],[8569,2],[7418,54],[4444,81],[3446,63],[3133,86],[2465,83],[5255,17],[7405,20],[8659,34],[1807,62],[4939,64],[2411,49],[3943,91],[5248,51],[9655,97],[6653,32],[1627,94],[4054,79],[4802,74],[8976,49],[3196,91],[5608,55],[5394,20],[9537,8],[1992,74],[7723,59],[742,90],[1396,65],[837,88],[2449,63],[3271,53],[6516,45],[7314,41],[4418,90],[4103,62],[7637,69],[2866,8],[7237,18],[4980,74],[24,15],[989,37],[5420,97],[6540,3],[9310,8],[4726,27],[9892,59],[8557,80],[1755,100],[7149,48],[3723,24],[5293,93],[8701,45],[3348,16],[5141,89],[9857,94],[3769,94],[5543,54],[2443,88],[2365,5],[7901,11],[5237,16],[7207,9],[714,3],[4899,84],[6392,44],[8111,26],[8066,73],[9205,86],[715,72],[2869,74],[4574,44],[8586,20],[2096,38],[9247,94],[5919,64],[375,72],[7379,29],[3470,39],[7817,56],[3703,43],[2889,87],[6609,86],[4624,68],[4346,38],[2753,16],[3647,22],[8007,26],[8490,78],[7879,98],[7026,34],[9354,51],[4676,8],[632,57],[8671,12],[201,14],[3336,72],[4569,92],[6076,2],[8426,88],[8305,15],[544,39],[7545,23],[4821,88],[6102,93],[9109,24],[372,77],[3744,70],[4883,38],[1873,23],[7838,43],[232,25],[4038,23],[7259,3],[417,68],[828,27],[8642,63],[3404,57],[6385,37],[3449,49],[9776,9],[1446,44],[7080,92],[1957,31],[7904,67],[407,18],[7051,80],[5148,29],[9293,6],[6677,8],[6083,52],[6735,74],[5816,80],[8321,14],[5236,62],[9582,35],[3295,71],[5005,83],[6907,44],[5939,94],[9970,30],[113,89],[9738,83],[6533,74],[8948,39],[8532,27],[9829,26],[2110,60],[4763,85],[9907,82],[3156,59],[1801,73],[4922,62],[3543,82],[4236,75],[5175,41],[4643,20],[3242,51],[6100,1],[6034,64],[3583,83],[8855,34],[6096,76],[6963,86],[6841,96],[4522,32],[5614,90],[5467,71],[3269,16],[8552,92],[1598,16],[1094,58],[8487,57],[3240,16],[4595,14],[3708,87],[5093,98],[2463,100],[6362,23],[2856,56],[8791,91],[9542,48],[2324,12],[4876,7],[4703,79],[7705,86],[2686,38],[9562,63],[8455,82],[9715,86],[700,3],[4913,48],[1004,40],[5776,5],[893,52],[8605,71],[368,2],[3783,68],[6017,72],[7993,12],[6936,21],[7226,34],[3376,73],[6172,15],[5672,46],[5256,20],[2277,33],[7559,27],[8332,64],[7576,50],[2700,31],[2974,85],[4882,43],[4987,9],[3054,75],[4767,43],[2813,94],[3773,48],[1799,50],[721,24],[2751,84],[9771,43],[3684,98],[8929,46],[6150,74],[7448,59],[165,61],[1143,20],[1529,87],[4764,21],[7050,81],[1876,21],[7744,25],[6414,28],[103,69],[1856,7],[9171,5],[5503,53],[6602,2],[6236,55],[3086,46],[476,32],[2840,95],[7935,96],[1474,37],[6472,23],[6363,60],[1772,50],[9168,86],[1965,79],[5846,72],[1849,78],[2644,20],[6205,24],[8833,63],[2107,89],[3730,50],[6466,46],[3022,53],[9271,77],[8874,31],[1519,90],[9210,44],[1996,80],[1149,72],[7820,6],[7793,35],[4426,1],[3711,37],[3560,74],[1406,16],[7771,79],[860,39],[4860,84],[5170,12],[7287,15],[2355,82],[5316,48],[4320,62],[7510,33],[3916,71],[5446,39],[2527,71],[4394,78],[8106,19],[918,90],[139,52],[5851,16],[9680,86],[827,49],[3532,68],[2576,77],[7710,18],[3408,62],[3414,42],[8462,78],[516,89],[7530,65],[9223,88],[5474,52],[2800,1],[9421,86],[4300,48],[1739,67],[9495,22],[6072,68],[3375,57],[5299,81],[7486,35],[1841,14],[244,36],[1225,76],[3003,3],[9718,17],[9959,60],[9821,90],[4422,24],[9387,11],[8223,85],[851,65],[765,9],[120,68],[9443,43],[9862,52],[1074,96],[2115,2],[7352,65],[5202,71],[4297,81],[3901,45],[2627,82],[4436,11],[1816,18],[8821,95],[3872,14],[4602,82],[2785,72],[8366,62],[2692,31],[2207,31],[3258,85],[8456,15],[10000,93],[8199,11],[6887,4],[3509,28],[655,60],[5834,43],[766,86],[6637,22],[9283,73],[3454,23],[9948,43],[7248,93],[4848,7],[2931,17],[2422,59],[2297,81],[1978,75],[70,65],[1344,56],[2832,46]],
        [[6971,76],[9803,11],[5059,25],[4414,87],[6629,31],[6717,96],[3892,59],[2739,56],[6224,63],[9335,97],[4225,72],[260,9],[3516,65],[1201,71],[3617,46],[1820,58],[5420,81],[6071,1],[5570,72],[6974,87],[8632,93],[1059,98],[9159,38],[4160,36],[8943,97],[4809,89],[404,41],[5248,94],[74,63],[3299,5],[4583,99],[2312,13],[39,92],[1581,73],[4288,76],[3186,21],[8497,76],[154,39],[1648,90],[4245,22],[8669,2],[9366,21],[5087,14],[914,59],[7572,14],[3439,5],[869,9],[9369,61],[6847,32],[6520,47],[936,56],[837,94],[9087,9],[3915,75],[1770,44],[383,97],[5836,76],[141,56],[5774,7],[9433,34],[3913,20],[2303,98],[2143,4],[1337,65],[1270,83],[2608,49],[7293,48],[8118,55],[961,17],[5780,53],[2273,18],[9886,96],[2522,43],[1989,2],[3443,49],[7959,48],[741,21],[3982,30],[5404,95],[9799,14],[6351,73],[6239,12],[7084,8],[8695,68],[9725,43],[7523,86],[8266,53],[7777,57],[5712,32],[1264,2],[1729,91],[7296,35],[2258,37],[2019,33],[316,58],[4831,96],[8639,54],[1249,39],[2515,41],[588,23],[3433,31],[7882,81],[1012,41],[4757,87],[821,31],[2723,22],[8740,86],[7568,35],[687,87],[4169,94],[1544,3],[1947,76],[5978,28],[6774,35],[1370,35],[2070,44],[9245,10],[9492,32],[8057,99],[1217,55],[3905,29],[5984,79],[1651,6],[5889,86],[4966,88],[6237,51],[5198,16],[359,68],[8849,73],[3143,83],[2656,94],[5638,22],[9025,94],[8622,95],[7477,56],[272,51],[3921,24],[9085,17],[1360,65],[2945,13],[3235,33],[9042,84],[8985,30],[185,11],[4828,80],[673,68],[3682,62],[6400,19],[9867,100],[2093,14],[7008,90],[7581,67],[369,6],[1199,96],[6977,77],[6259,82],[278,20],[3713,51],[4011,45],[4843,44],[8150,16],[6620,19],[9941,67],[681,15],[2033,45],[9598,91],[7585,77],[2043,84],[8348,16],[7081,12],[8034,21],[2980,26],[8104,53],[7780,73],[4054,21],[8085,94],[6691,8],[8066,43],[9209,43],[4046,48],[2137,28],[8665,42],[6838,39],[1460,15],[6272,24],[2508,13],[2599,17],[4649,63],[7649,99],[4599,12],[5497,32],[7428,86],[5489,25],[2926,24],[7782,40],[7700,61],[7000,81],[622,84],[4313,32],[7935,88],[5193,76],[8308,35],[7519,3],[273,82],[4875,98],[7214,94],[8630,10],[248,43],[5062,57],[4889,84],[9364,94],[1181,97],[8012,24],[7373,95],[3024,76],[1418,45],[4873,56],[4401,5],[3829,93],[6214,92],[1006,80],[5243,50],[7205,19],[8257,14],[4658,71],[3652,96],[4560,50],[7150,35],[2744,81],[3619,5],[2902,92],[7923,14],[4239,12],[5956,75],[733,51],[1303,73],[3079,53],[4994,98],[2377,84],[2778,19],[8836,8],[5915,93],[4091,68],[3917,42],[1187,17],[1324,56],[5968,15],[8175,51],[5555,99],[2128,48],[6052,41],[8889,6],[6428,27],[2474,19],[7995,85],[5313,1],[3194,80],[3027,52],[2015,76],[2896,50],[6288,15],[6553,30],[1510,90],[8504,83],[7746,13],[6097,25],[1088,71],[3567,89],[4721,86],[6026,80],[3220,27],[3846,6],[3373,74],[9767,48],[785,16],[7411,4],[1935,56],[4784,73],[9205,9],[9595,42],[2805,43],[8975,59],[5551,60],[7306,42],[6189,1],[7914,63],[472,99],[7998,66],[8907,2],[3101,73],[2084,15],[7714,52],[7342,40],[6517,11],[7565,8],[6204,33],[1325,73],[2596,51],[4006,21],[5733,8],[9023,37],[5418,62],[2158,36],[3602,36],[9339,93],[2520,11],[8223,42],[3008,7],[5058,94],[6725,22],[2870,2],[2180,21],[4354,76],[9903,73],[6526,89],[3431,99],[3599,32],[3874,93],[9817,85],[7080,8],[2482,39],[87,85],[9733,79],[9820,49],[2844,86],[7295,32],[5311,46],[3525,64],[1498,65],[6516,90],[600,52],[1570,83],[9711,3],[7928,12],[5351,11],[8783,41],[4058,25],[13,88],[2449,12],[3130,32],[1611,86],[7672,6],[2949,19],[1937,73],[4157,33],[6539,96],[7267,24],[4404,26],[8570,53],[6968,12],[7563,45],[8853,80],[8620,72],[3881,32],[1000,26],[5553,68],[51,53],[9824,76],[8366,60],[1150,36],[897,74],[9086,3],[6018,6],[1752,25],[151,62],[7600,59],[8910,38],[9104,47],[5528,10],[684,51],[7476,60],[7366,72],[2175,100],[6171,37],[9319,1],[1741,86],[9152,52],[5567,22],[8231,100],[4974,37],[877,35],[5547,51],[5979,23],[6249,41],[3156,65],[3825,62],[1825,96],[6912,32],[6882,10],[3624,100],[881,63],[4705,48],[6469,49],[2986,91],[552,17],[4200,30],[6756,92],[6091,91],[9377,89],[3430,87],[3622,31],[6557,8],[8546,100],[611,6],[2197,54],[7499,71],[9076,75],[1052,39]]
    ],
    [54,13,254,48,157,7,177,235,96,2,119,630,162,203,246,255,60,273,87,27,8,17,49,269,2,39,422,20,279,461,3,493,51,177,100,392,28,436,57,321,91,39,295,275,136,447,591,18,146,124,286,39,64,109,348,22,73,313,279,27,341,15,543,223,107,281,101,59,536,142,464,0,325,563,241,72,528,290,13,13,71,225,189,29,13,27,57,65,203,613,51,122,362,385,301,13,43,394,335,524,322,31,397,45,460,414,17,104,82,24,592,147,199,142,414,332,53,25,1,286,301,62,572,46,42,123,276,235,25,87,33,234,5,4,76,348,320,60,223,449,328,16,53,625,77,228,175,200,0,498,22,53,647,24,52,51,560,214,235,212,99,188,1,573,323,4,41,92,93,178,100,377,60,42,330,7,212,79,43,222,409,61,133,531,192,479,448,140,1,335,211,29,229,389,91,59,42,110,276,17,81,80,160,130,8,11,86,415,147,58,3,21,100,6,125,351,155,385,29,21,135,169,158,101,113,18,195,130,107,429,39,116,362,72,331,181,239,8,90,427,79,22,135,255,527,278,238,62,3,304,165,76,173,444,23,322,104,246,143,263,215,160,59,22,128,198,204,50,54,60,353,407,130,10,558,170,259,101,57,19,316,33,121,111,258,53,10,43,79,140,492,73,112,212,150,173,181,267,333,280,50,121,369,293,4,488,77,476,21,174,506,450,99,2,28,8,306,28,3,190,341,109,5,8,74,127,180,172,220,26,331,105,19,119,284,59,310,82,488,340,85,148,417,168,278,9,146,295,45,185,89,20,28,289,481,98,344,3,48,415,181,71,264,452,283,66,56,41,274,334,66,50,6,162,49,83,37,238,1,224,432,151,216,153,173,170,23,144,195,3,253,199,122,45,561,285,18,27,6,60,307,221,1,630,264,50,22,401]
)
run_test(method,
    [
        [[6612,2],[8958,36],[2093,1],[5043,71],[1086,46],[7324,94],[2983,47],[1993,42],[6969,85],[6203,48],[1579,64],[4237,84],[7419,57],[5048,71],[763,48],[1578,7],[5912,60],[8804,3],[8717,61],[3319,62],[9004,51],[2101,15],[5302,6],[1094,23],[7807,91],[9447,98],[703,16],[2306,60],[3342,87],[345,4],[686,48],[9206,59],[4969,69],[9894,23],[7792,69],[8018,57],[3747,54],[8994,79],[5244,94],[9028,36],[6868,4],[9231,65],[5520,84],[8330,72],[2538,99],[2074,90],[1630,29],[9118,92],[9441,88],[4945,75],[6674,2],[4500,73],[8863,50],[2722,42],[5897,47],[8973,29],[9912,43],[9541,62],[6571,3],[3039,14],[6177,12],[2945,85],[1242,24],[306,81],[3422,46],[8775,29],[7207,4],[9076,56],[2711,60],[2383,40],[1137,73],[6173,81],[2558,77],[2127,35],[2591,65],[9508,79],[9987,16],[5418,91],[862,13],[4258,10],[569,19],[8645,64],[1673,59],[8322,25],[9046,95],[5218,39],[1696,94],[8334,56],[7928,47],[6941,74],[2643,11],[7160,50],[9086,25],[2156,40],[9763,30],[3172,22],[1679,83],[5602,24],[203,32],[8959,12],[6436,54],[1106,13],[1195,38],[4630,83],[7865,14],[3074,64],[8037,38],[6020,64],[4978,50],[5743,99],[5565,35],[757,54],[9146,20],[9019,39],[6565,41],[6522,32],[2644,99],[2131,84],[993,69],[9780,17],[2700,6],[5886,61],[5781,6],[9818,22],[7990,10],[3182,12],[6662,21],[6133,4],[9319,12],[4707,45],[3474,67],[4894,4],[6015,53],[7644,51],[5601,22],[9179,64],[458,77],[1987,12],[4602,86],[2049,22],[6862,43],[1659,67],[8345,69],[9691,96],[2197,8],[153,58],[6994,32],[6390,89],[4297,80],[8630,75],[7355,91],[1236,47],[2242,73],[8350,2],[4476,16],[7955,47],[1783,65],[2984,4],[3479,98],[4662,86],[2579,66],[8246,6],[1091,19],[4291,74],[6272,49],[2977,55],[1179,25],[3613,73],[5984,72],[4119,58],[3543,57],[5667,73],[6250,37],[9622,96],[1732,96],[922,25],[372,83],[8820,100],[3438,12],[8064,40],[1446,26],[3603,86],[2882,95],[5208,39],[9199,19],[6829,91],[5160,20],[6797,82],[3128,84],[4202,6],[3084,10],[5311,90],[2625,73],[8435,77],[1933,99],[2524,11],[7770,56],[9336,14],[1815,4],[7511,4],[8161,37],[603,41],[5721,8],[5479,24],[3588,91],[8933,61],[759,67],[5961,4],[1930,92],[9808,27],[9212,33],[9253,97],[2958,57],[5662,36],[9991,78],[6221,18],[8358,79],[8711,81],[6351,99],[9619,41],[4100,3],[170,21],[4934,72],[7031,51],[3858,81],[2065,85],[3733,32],[2472,97],[3687,74],[9187,39],[7111,89],[6094,75],[3816,29],[4121,51],[5953,41],[4999,69],[5178,72],[2350,46],[9313,42],[105,53],[3649,57],[6040,43],[7006,20],[4937,15],[5906,73],[1012,28],[416,41],[8818,82],[9679,33],[3600,14],[1358,5],[649,59],[9205,58],[3193,12],[1675,83],[5835,29],[4193,66],[6459,59],[2575,7],[4122,66],[3771,34],[7265,78],[6326,74],[965,5],[5962,29],[3352,27],[6402,32],[3666,83],[2496,67],[8460,15],[6698,91],[4218,26],[8899,89],[2459,90],[2571,43],[4158,82],[4726,83],[4672,18],[7752,98],[5844,10],[5683,15],[708,2],[3295,77],[2682,25],[5112,6],[2259,54],[725,20],[5632,88],[4460,60],[9091,80],[57,6],[6544,34],[9616,41],[3985,45],[9097,14],[7488,43],[684,40],[1834,58],[6289,92],[5822,35],[5888,75],[6139,71],[7198,61],[9992,65],[7411,12],[4792,46],[6699,10],[3663,30],[9603,78],[2453,12],[5334,36],[5859,37],[561,48],[8110,98],[550,27],[4676,79],[4268,92],[487,82],[5637,56],[5230,48],[2820,52],[6752,54],[4860,27],[7321,51],[5300,89],[4157,73],[4249,65],[7281,87],[8184,27],[6230,61],[2444,66],[6444,97],[8076,57],[5478,52],[7090,49],[186,43],[6639,26],[7552,36],[1859,4],[1124,94],[3351,23],[5185,93],[9743,44],[4463,56],[1963,25],[7573,15],[9907,19],[6490,36],[1346,68],[8915,99],[6822,95],[2665,60],[2208,16],[3376,71],[4260,35],[3461,46],[577,30],[3570,29],[8632,25],[8015,43],[5763,63],[7571,86],[5296,37],[122,39],[7460,92],[813,48],[2181,49],[4875,32],[3484,88],[3841,79],[5927,13],[7826,77],[9624,23],[9835,49],[6347,26],[9536,84],[9672,48],[8888,46],[8455,59],[2765,74],[9820,26],[3875,34],[7720,57],[4214,100],[5534,92],[8965,80],[406,58],[8426,5],[2864,49],[25,49],[7078,67],[314,47],[6893,32],[7856,90],[7434,78],[7816,47],[70,86],[1025,32],[9387,74],[5873,59],[7012,51],[7471,45],[7394,44],[2924,16],[1603,6],[6948,47],[5073,2],[159,7],[8363,7],[2798,15],[1836,51],[1369,75],[2536,31],[7301,23],[2139,60],[9125,28],[6512,70],[2793,3],[2227,78],[3615,85],[6427,70],[2029,11],[4270,44],[6887,52],[7380,73],[6073,50],[5806,18],[8000,4],[9138,81],[6303,97],[4924,76],[4180,32],[8520,95],[5394,28],[5472,57],[1480,30],[2950,44],[4562,50],[4125,36],[5956,8],[9932,42],[2506,14],[7484,23],[2701,66],[3607,50],[7942,99],[1801,19],[2261,96],[202,38],[4994,97],[6098,88],[5133,73],[1500,38],[4619,73],[9502,1],[9986,72],[1255,74],[5920,60],[6407,13],[1598,30],[5226,49],[1171,54],[2712,12],[2826,47],[8755,8],[9466,44],[9602,27],[7731,51],[3978,59],[7424,48],[4683,10],[8867,63],[1955,15],[2206,75],[4494,52],[6112,29],[9847,26],[84,55],[3820,29],[2190,76],[5441,78],[9592,95],[5933,16],[8625,43],[7610,68],[4490,65],[1184,65],[920,47],[1052,85],[3720,29],[7315,23],[4992,93],[1110,15],[2280,1],[2542,66],[2232,28],[4262,67],[567,93],[5255,50],[3828,21],[6172,75],[3166,67],[143,4],[6408,79],[7803,67],[7313,37],[9063,51],[2776,49],[9872,86],[2207,92],[1645,39],[6090,37],[3515,75],[2497,39],[7561,58],[9329,46],[6654,79],[8106,25],[4952,22],[3408,49],[6322,7],[2680,22],[6154,65],[7518,13],[2123,74],[4160,18],[9725,94],[9221,21],[5012,23],[9874,8],[973,41],[1240,13],[2433,97],[3091,90],[2740,40],[2907,53],[8777,33],[7582,21],[3379,45],[5188,49],[8517,37],[9862,89],[2499,81],[4146,94],[2257,7],[5851,13],[6966,70],[6660,1],[5144,6],[3302,18],[1356,68],[8642,42],[8550,9],[5674,73],[3473,13],[8083,93],[6832,90],[4957,94],[2424,45],[1777,60],[2829,90],[8482,65],[4084,12],[49,21],[2651,28],[5854,49],[7470,82],[5173,92],[2837,64],[8763,60],[1939,97],[9829,86],[2763,71],[332,54],[284,92],[9480,84],[835,91],[7400,79],[4920,25],[1475,91],[7271,48],[7159,11],[9132,68],[6100,18],[6329,21],[774,17],[1142,14],[4441,55],[712,28],[5294,52],[2991,2],[3864,23],[7524,49],[9376,11],[8989,3],[8553,45],[6144,95],[1982,40],[5458,90],[4381,43],[699,25],[7291,64],[1936,84],[9804,55],[2354,39],[4643,40],[878,75],[9310,62],[2526,74],[1559,40],[1172,20],[1308,17],[3469,97],[199,11],[3049,85],[8261,89],[2502,86],[8810,95],[1398,73],[6611,2],[8251,27],[7233,20],[7302,76],[4507,55],[2363,96],[5718,69],[3705,41],[6428,3],[1945,39],[2179,31],[4497,97],[1075,24],[1388,4],[748,50],[7922,88],[8440,53],[9200,80],[5681,78],[4062,26],[6597,81],[1937,26],[9172,91],[9750,7],[182,12],[824,56],[495,88],[3555,2],[1082,67],[4019,96],[5958,90],[2781,56],[112,92],[5353,76],[3198,79],[9669,69],[9662,57],[2928,96],[4254,54],[7843,66],[4673,51],[2710,24],[8346,36],[3583,96],[5869,60],[4205,5],[3139,100],[2716,39],[7845,24],[3233,9],[957,7],[9043,95],[5137,36],[2358,59],[2264,77],[3691,58],[1551,81],[1312,24],[2607,87],[2126,63],[7135,38],[7162,62],[700,20],[7601,36],[2371,19],[7462,75],[9823,52]],
        [[1962,26],[4281,82],[8009,2],[426,55],[2773,37],[2996,68],[7714,77],[2750,67],[6356,63],[3903,89],[6878,46],[3629,50],[6410,4],[5143,74],[3727,90],[6568,42],[7466,58],[8176,9],[5520,10],[1253,87],[5208,36],[9387,5],[9341,82],[6075,3],[318,54],[5203,30],[551,29],[2213,39],[953,53],[8461,56],[9050,52],[7163,65],[3753,32],[6759,70],[6382,38],[5503,79],[8090,99],[7154,91],[6248,62],[6170,28],[6389,17],[5367,98],[9265,44],[2521,73],[8935,50],[2638,26],[1398,45],[8093,96],[4716,77],[9133,68],[8243,49],[9193,83],[6768,18],[597,78],[3614,44],[2710,85],[1898,69],[5659,51],[1182,50],[6013,40],[1564,84],[4912,4],[3084,12],[129,78],[7223,43],[470,53],[489,7],[3350,53],[706,11],[5718,21],[1714,53],[4501,3],[7121,2],[8552,49],[9086,33],[4428,4],[9420,44],[3216,99],[5942,8],[4024,89],[3896,7],[3656,24],[7263,81],[3221,76],[6938,72],[8437,34],[4361,71],[3076,31],[1022,80],[6501,47],[1622,82],[7837,98],[8159,58],[5888,35],[6101,23],[9680,77],[6791,50],[3264,9],[8459,54],[1828,32],[1092,82],[1737,4],[278,59],[9221,100],[7948,56],[9618,34],[3206,50],[7002,3],[3758,98],[4175,59],[83,90],[9803,33],[7142,89],[3468,63],[3225,6],[4763,63],[6362,66],[4960,34],[9739,76],[209,37],[423,93],[5778,72],[7210,72],[7035,87],[4700,14],[6222,8],[3420,9],[6464,70],[5106,76],[3574,35],[4105,24],[9405,19],[5879,100],[4250,67],[7082,16],[8108,43],[7132,48],[7927,73],[2763,59],[7054,72],[1877,63],[5602,97],[1097,91],[8846,97],[1008,21],[5532,23],[5213,18],[2440,13],[3926,70],[3211,27],[7587,52],[7385,55],[4611,63],[2141,85],[8816,6],[1970,71],[3487,67],[657,35],[8549,73],[2881,66],[6102,37],[9268,59],[8290,4],[9176,20],[8895,98],[9667,93],[4825,38],[7489,90],[9211,8],[5591,37],[6811,70],[9276,1],[1071,4],[1868,17],[7600,54],[4662,37],[6462,14],[9208,12],[5978,88],[8822,93],[7791,74],[5334,52],[9057,23],[1882,29],[1535,12],[8311,78],[9273,43],[2208,12],[1675,95],[5152,32],[1361,1],[3151,2],[6261,48],[9697,11],[2870,71],[3103,45],[7041,37],[6049,93],[8920,14],[5011,71],[5819,71],[8938,31],[8541,93],[8760,27],[2882,22],[7265,53],[935,29],[9449,80],[9224,4],[6275,56],[6940,69],[4820,77],[3907,84],[6149,23],[3801,7],[543,45],[8070,88],[8668,25],[9047,89],[7426,56],[6827,87],[8479,95],[2515,1],[5848,14],[8568,50],[9539,91],[2184,17],[4622,18],[7784,78],[822,81],[1585,99],[4608,69],[3519,82],[9097,61],[9445,27],[2008,24],[3205,93],[7463,52],[2716,58],[4503,98],[2011,2],[9515,86],[5467,59],[8690,76],[911,30],[287,93],[892,64],[5614,80],[1667,12],[7101,34],[9143,60],[6461,47],[482,34],[738,10],[6932,50],[901,29],[8089,54],[7392,41],[3480,49],[8177,19],[9117,68],[8946,67],[101,36],[1469,26],[884,17],[3979,6],[5049,44],[1107,3],[319,40],[9422,30],[4916,87],[4727,6],[7677,5],[4637,55],[786,74],[6875,95],[8789,23],[2830,17],[9121,88],[57,51],[7295,34],[8671,31],[1912,1],[9291,20],[5727,75],[972,41],[5523,22],[4947,20],[4147,28],[1825,68],[9832,78],[3774,11],[2704,15],[5788,5],[9109,22],[6799,90],[5023,23],[8374,19],[2009,95],[6966,16],[7608,55],[5403,74],[7733,32],[2953,47],[4928,97],[8536,74],[2780,63],[5489,75],[1526,42],[2832,87],[2332,69],[7789,70],[7615,78],[6821,85],[3476,95],[6514,84],[9643,14],[1300,93],[8910,71],[9894,13],[737,38],[9010,57],[3364,24],[7229,83],[9279,73],[1704,30],[8143,5],[7038,43],[626,32],[43,48],[4908,61],[2132,77],[7689,58],[7550,70],[2749,33],[3286,83],[7681,95],[8642,11],[4953,57],[9560,68],[5525,12],[2103,30],[3415,10],[894,91],[8380,74],[3588,45],[9931,17],[3210,45],[1159,71],[1339,31],[324,21],[307,87],[1456,13],[6171,88],[1460,46],[7196,90],[681,2],[8156,99],[918,28],[3967,55],[3697,21],[5964,52],[361,96],[8982,43],[1834,51],[4263,45],[2723,48],[5578,28],[8138,78],[3691,84],[3849,22],[3051,33],[7950,35],[8794,82],[5188,11],[776,78],[4157,33],[8607,76],[5664,3],[258,32],[2077,37],[5486,79],[4434,94],[8780,72],[4487,35],[249,47],[5693,14],[1914,63],[6785,26],[8000,17],[6645,4],[4562,31],[8477,9],[6029,30],[8944,71],[2793,48],[7579,97],[8723,54],[5755,63],[342,32],[8088,39],[3658,82],[5456,30],[421,52],[4894,76],[3987,87],[4726,27],[191,41],[3819,26],[2736,32],[813,100],[5748,83],[8580,28],[3002,30],[2250,55],[3299,80],[5622,20],[5324,48],[7535,30],[7433,17],[4075,90],[9336,51],[8360,50],[8105,83],[5785,31],[9377,98],[220,80],[9765,41],[7257,55],[1327,82],[4601,70],[2110,19],[5442,76],[5505,32],[4207,50],[38,54],[3325,7],[4647,12],[9148,58],[6772,69],[2731,93],[7636,45],[6809,20],[8187,46],[3552,86],[4456,98],[4265,16],[1532,63],[5726,69],[6077,74],[9228,50],[3018,60],[9329,98],[1604,75],[5202,72],[6576,12],[7763,98],[7026,31],[4033,35],[481,49],[214,80],[3153,42],[5344,52],[4383,11],[7358,20],[7214,46],[7757,93],[5341,5],[6544,47],[9619,66],[7442,32],[119,80],[986,7],[7322,32],[5963,87],[2533,44],[1424,31],[2997,13],[2088,88],[2281,29],[8087,16],[8399,61],[3030,88],[695,88],[5020,39],[1318,13],[1226,44],[2449,36],[4092,49],[8432,45],[3122,31],[5601,77],[7716,96],[6296,74],[2134,83],[2495,36],[5101,11],[8651,6],[4061,28],[5910,58],[4583,79],[270,94],[3607,95],[5251,28],[5169,14],[90,32],[499,98],[2326,60],[349,41],[5992,94],[7685,87],[6657,53],[3358,37],[6136,53],[3672,41],[3754,72],[9454,4],[8915,2],[1028,31],[1027,89],[2055,51],[3003,13],[3490,56],[5121,9],[3996,35],[9899,36],[7095,63],[9595,89],[3040,67],[1662,67],[7987,82],[5435,72],[7657,4],[8732,73],[6665,12],[7190,56],[4531,24],[7239,40],[6567,98],[4818,94],[8523,87],[552,31],[4190,24],[7943,72],[1521,51],[5059,62],[126,92],[6390,48],[4575,71],[4896,100],[7819,5],[620,66],[6363,93],[8172,30],[4083,50],[6199,20],[8509,70],[573,25],[1388,56],[2657,86],[7444,87],[3338,47],[2269,90],[2553,61],[5325,58],[7952,57],[8891,67],[5187,34],[7278,30],[2361,12],[4795,88],[8002,11],[3526,48],[8167,88],[5459,59],[1790,45],[6590,4],[9498,53],[1064,58],[2933,6],[6205,77],[8525,45],[6137,92],[8721,77],[6880,50],[775,15],[1218,46],[1504,37],[4416,12],[3080,89],[4133,84],[138,5],[6711,69],[3057,39],[1845,61],[6217,98],[8572,38],[3073,30],[1641,99],[533,52],[4702,21],[135,100],[3263,96],[2717,48],[3708,33],[9903,91],[9966,15],[2375,92],[167,70],[8743,51],[2458,48],[2246,28],[148,77],[9876,16],[2664,3],[6100,54],[7483,59],[4804,96],[7727,85],[6065,57],[3970,36],[8878,19],[3398,89],[6051,17],[7482,86],[9493,14],[5170,64],[5363,59],[178,62],[915,59],[7314,19],[7144,30],[4317,45],[5019,100],[6141,48],[5627,96],[9851,14],[3496,66],[6546,13],[5793,49],[5571,32],[2147,15],[523,70],[891,97],[8605,96],[3810,74],[1706,92],[1978,19],[445,95],[1213,97]]
    ],
    [431,70,134,301,324,160,42,171,89,55,121,224,227,93,49,142,70,116,282,87,227,44,11,259,311,238,472,353,301,51,35,68,301,66,157,68,2,22,96,188,205,8,28,151,41,385,348,7,87,21,65,12,186,145,253,81,191,151,318,171,105,343,420,151,117,310,618,216,585,241,281,364,195,55,47,368,25,6,254,54,383,338,38,114,61,77,119,333,128,128,114,5,55,194,210,6,113,420,52,409,116,562,279,0,62,19,240,200,9,169,78,11,26,171,434,135,82,243,4,437,50,84,58,30,315,232,411,70,85,301,320,39,1,136,172,74,106,39,207,59,222,11,65,3,508,245,278,463,131,347,77,83,140,91,89,178,152,437,32,171,173,20,118,51,2,2,228,20,53,201,65,51,607,481,75,241,204,51,40,9,43,154,58,420,532,32,29,489,39,241,600,459,135,22,152,272,136,22,77,105,85,57,11,74,388,91,456,9,52,113,65,86,70,207,390,374,20,79,9,80,32,11,516,251,54,4,461,311,39,125,10,125,81,28,32,439,35,80,211,8,557,7,130,30,447,50,239,60,525,139,25,128,446,589,108,457,60,113,240,107,23,28,453,456,530,388,197,607,414,31,55,339,149,167,173,14,76,408,9,337,130,70,572,42,77,385,247,291,297,193,3,377,429,276,55,26,273,98,36,179,75,87,108,268,12,32,186,81,364,70,176,45,40,37,26,40,27,48,27,8,414,34,357,34,15,416,123,123,452,365,143,134,66,47,345,81,14,95,156,11,276,402,410,65,34,253,4,268,191,429,537,91,524,38,341,23,647,2,462,192,349,130,31,46,294,226,274,224,33,70,336,327,93,21,299,145,283,30,295,465,371,68,26,31,262,370,257,222,168,117,216,266,103,193,26,270,7,46,106,461,81,77,224,317,89,60,270,409,320,353,3,48,78,337,254,94,250,173,117,148,48,22,59,23,208,1,135,11,90,115,120,462,77,220,208,317,424,327,27,69,38,89,183,68,68,8,331,230,92,77,25,195,1,157,98,203,5,145,284,345,135,284,154,343,150,108,15,301,127,9,122,135,589,130,41,307,425,415,77,395,112,47,66,86,217,529,358,358,222,64,332,73,9,71,99,356,305,96,302,118,83,46,24,240,292,472,14,222,405,21,25,104,299,123,265,127,41,84,439,80,288,415,202,309,285,5,73,4,165,203,25,93,150,30,199,90,291,123,6,25,16,457,312,40,304,128,59,130,117,1,141,226,19,88,215,212,34,500,278,77,26,256,64,204,136,60,30,231,136,478,54,124,243,18,130,336,218,17,271,451,66,59,25,29,109,547,347,394,341,61,69,647,69,299,231,7,69,336,10,314,296,3,20,274,296,0,4,48,206,49,291,401,157,8,492,122,67,14,27,118,284,76,59,227,28,37,122,133,256,268,156,141,223,1,141,13,10,155,201,153,217,474,200,23,6,114,55,467,39,23]
)
