from enum import IntEnum
from numpy import Infinity
from test_utils import run_test
from typing import List, Tuple
from math import sqrt, ceil, floor
import re
import numpy as np
from functools import cache


def find_axis_horz(pattern: List[str], expect_smudge=True, forbidden_match: int | None = None):
    smudge_offset_from_axis = None
    smudge_coord_on_axis = None
    for y in range(len(pattern) - 1):
        if y == forbidden_match:
            continue
        smudge = expect_smudge
        mirror = True
        for k in range(y + 1):
            if y + 1 + k >= len(pattern):
                break
            for x in range(len(pattern[0])):
                if pattern[y - k][x] != pattern[y + 1 + k][x]:
                    if smudge:
                        smudge_offset_from_axis = k
                        smudge_coord_on_axis = x
                        smudge = False
                    else:
                        mirror = False
                        break
            if not mirror:
                break
        if mirror and not smudge:
            return y, smudge_offset_from_axis, smudge_coord_on_axis
    return None, None, None


def find_axis_vert(pattern: List[str], expect_smudge=True, forbidden_match: int | None = None):
    smudge_offset_from_axis = None
    smudge_coord_on_axis = None
    for x in range(len(pattern[0]) - 1):
        if x == forbidden_match:
            continue
        smudge = expect_smudge
        mirror = True
        for k in range(x + 1):
            if x + 1 + k >= len(pattern[0]):
                break
            for y in range(len(pattern)):
                if pattern[y][x - k] != pattern[y][x + 1 + k]:
                    if smudge:
                        smudge_offset_from_axis = k
                        smudge_coord_on_axis = y
                        smudge = False
                    else:
                        mirror = False
                        break
            if not mirror:
                break
        if mirror and not smudge:
            return x, smudge_offset_from_axis, smudge_coord_on_axis
    return None, None, None


def flip_cell(pattern: List[str], x: int, y: int) -> List[str]:
    new_pattern = [l for l in pattern]
    s = new_pattern[y]
    new_s = s[:x] + ('#' if s[x] == '.' else '.') + s[x + 1:]
    new_pattern[y] = new_s
    return new_pattern


def solve(data: str, fix_smudge: bool = False) -> int:
    patterns = data.split('\n\n')
    r = 0
    for pp in patterns:
        print('_______________________________________')
        print(pp)
        pattern = pp.splitlines()

        forbidden_match = None
        x, _, _ = find_axis_vert(pattern, False)
        if x is not None:
            if fix_smudge:
                print('Original match, left-hand columns:', x + 1)
                forbidden_match = x, _
            else:
                print('mirror, left-hand columns:', x + 1)
                r += x + 1
        else:
            y, _, _ = find_axis_horz(pattern, False)
            if y is not None:
                if fix_smudge:
                    print('Original match, top-side rows:', y + 1)
                    forbidden_match = _, y
                else:
                    print('mirror, top-side rows:', y + 1)
                    r += 100 * y + 100
            else:
                assert False, 'Exactly one mirror axis expected.'

        if fix_smudge:
            ps = []
            axis_x, o, c = find_axis_vert(pattern, True)
            if axis_x is not None:
                print('Smudge along vertical line, X',
                      axis_x, '+/-', o, ', Y:', c)
                ps.append(flip_cell(pattern, axis_x - o, c))
                ps.append(flip_cell(pattern, axis_x + o + 1, c))
            else:
                axis_y, o, c = find_axis_horz(pattern, True)
                if axis_y is not None:
                    print('Smudge along vertical line, Y',
                          axis_y, '+/-', o, ', X:', c)
                    ps.append(flip_cell(pattern, c, axis_y - o))
                    ps.append(flip_cell(pattern, c, axis_y + o + 1))
                else:
                    assert False, 'Exactly one smudge expected.'

            for pattern in ps:
                print()
                print('\n'.join(pattern))
                x, _, _ = find_axis_vert(pattern, False, forbidden_match[0])
                if x is not None:
                    print('mirror, left-hand columns:', x + 1)
                    r += x + 1
                    break
                else:
                    y, _, _ = find_axis_horz(
                        pattern, False, forbidden_match[1])
                    if y is not None:
                        print('mirror, top-side rows:', y + 1)
                        r += 100 * y + 100
                        break
                    else:
                        assert False, 'Exactly one mirror axis expected.'
    return r


small_vector = ''
official_vector = ''


def run_tests():
    run_test(solve, ['''#####.#.#.#..#.#.
#..###.###.##.###
....#...#..##..#.
#..####..#....#..
#..###..#.####.#.
#####.#.#..##..#.
#####.#.#####.##.
.##..###..####..#
#..#.#..########.
#..##.#####..####
####...#..#..#..#
''', True], 10)
    run_test(solve, [small_vector], 405)
    run_test(solve, [official_vector], 30158)
    run_test(solve, [small_vector, True], 400)
    run_test(solve, [official_vector, True], 36474)


small_vector = '''#.##..##.
..#.##.#.
##......#
##......#
..#.##.#.
..##..##.
#.#.##.#.

#...##..#
#....#..#
..##..###
#####.##.
#####.##.
..##..###
#....#..#'''

official_vector = '''#.#.##.##.#
#..#..####.
#.#####..##
#.##..####.
##.#..####.
..#...#..#.
##...#....#
....##....#
##.##.#..#.
#..#.##..##
##.###.##.#
...#.#.##.#
.#.#.#.##.#
##.###.##.#
#..#.##..##

##.#...#.#.
##.##..#.#.
.#.##......
..######..#
..######..#
.#.##......
##.##..#.#.
##.#...#.#.
...##...#..
...#.###..#
#..#######.
..#.##.###.
..###.##.#.
..##.##.##.
..#.#..##..

#.....###..###.
.###....#..#...
.#..#.#..##..#.
##.##.#..##..#.
.#....#.#..#.#.
.###.#..#..#..#
#.###..######..
#..#...######..
..#.##.##..##.#
..#.##.##..##.#
#......######..

.##.#######
.##....##.#
#..#.#.#.##
#####....##
####.....##
#..#.#.#.##
.##....##.#
.##.#######
####.#.###.
#..#####..#
......#####
........###
#..###.###.

#..##..
#..#...
###.#..
##..###
####.##
..#.#..
..#.###
.##.##.
.##.##.
..#.###
..#.#..

##.##.#####
#.####.#.##
..#..#....#
#########..
########.##
...##...#.#
.#....#...#
########..#
..####.....
#......###.
#......###.
..####.....
########..#
.#....#...#
...##...#..
########.##
#########..

...#.#..#....#.
#.##..##.####.#
.##.#.##.#..#.#
#.#.#..##.##.##
..#.######..###
...#.###......#
.##...##......#
##..#.##.####.#
.###......##...
##..#..#..##..#
####.#..##..##.
.###..#.######.
#....##...##...
#.....#...##...
.###..#.######.

#..####
.##.#..
.##.#.#
#..####
#..####
.##.#.#
.##.#..
#..####
.##...#
#..###.
..###..

##.##.....#.#
##.##.......#
......#.##...
##.#.#..#.#..
##.#..#######
##...###..#..
##.##.#..#.##
####.#...#..#
###.....####.
...##....#...
...##.#.##.##
....#..#...##
###...#......

#####.##..#
#.#..######
.#.#...####
.#.#...####
#.#..######
###.#.##..#
...#.######
##.#...####
....#..####
.#.#....##.
.....#.#..#

.#....#.#..##
.#....#....##
..#..#.......
.##..##...###
##########..#
.#.##.#.###.#
..#..#...#.##
#.####.##..#.
.#....#..##..
#......###.##
.#.##.#..###.
...##...####.
.#....#...#..
##.##.####.##
##....##...##
#.####.####..
###..#####.##

.##.####....#
.##.#..####.#
#####...#.###
.......#.....
####.#...##..
.##....####.#
.##....######
.##....######
.##....####.#
####.#...##..
.......#.....
#####...#.###
.##.#..####.#
.##.####....#
.###..#...##.

#####.#.#.#..#.#.
#..###.###.##.###
....#...#..##..#.
#..####..#....#..
#..###..#.####.#.
#####.#.#..##..#.
#####.#.#####.##.
.##..###..####..#
#..#.#..########.
#..##.#####..####
####...#..#..#..#

########.....
...##.....##.
.........####
#.#..#.#####.
#.#######..#.
#.####.#.#..#
###..#####.#.
#.#..#.#..##.
..####....#.#
..####...#...
#.#..#.#.#..#
#.####.#.....
#.####.#.....

###....#.##.#.#
..#....#....###
#####.#..#.#.##
##.#.#..##..#..
..###..##...#..
#####.##...####
.....#...##.##.
###....####..##
##.###.##.###..
..##.####.#...#
###.##...#..###
..##.#..##.#...
..##.##.##.#...
###.##...#..###
..##.####.#...#

.#......#.#######
............####.
....##.....##..##
.###..###........
....##....#..##..
##.#..#.##.######
...####...#######
..######..##.##.#
.########..#.##..
###....#####.##.#
#...##...##......
...#..#...#..##..
##.####.##.......
.##....##.#..##..
#.##..##.#.#.##.#
.#.#..#.#.##.##.#
.##.##.##.##.##.#

....#.#.#..#.#.
####.#..#.#.#..
#..##.#.#..####
####..###......
....###.#.###..
....#.##....#.#
#..##.###.####.
....##.#...#...
#..#.#.#.#..###
####.#.#...##..
####.#.#...##..
#..#.#.#.#..#.#
....##.#...#...
#..##.###.####.
....#.##....#.#
....###.#.###..
####..###......

..#####....#####.
##..##########..#
.##.#..####..#.##
..######..######.
..######..######.
.##.#..####..#.##
##..##########..#
..#####....#####.
.....########....
..#..##....##..#.
.###.##.##.##.###
.#.#####..#####.#
..#....#..#.#..#.

.###.##.###
.###.##.###
####....#.#
#...####...
####....###
.#...##...#
..###..###.
#..#.##.#..
#....##....

#.#.#.#....#.
###..##.##.##
...##.#....#.
..##.#.####.#
##.#.#.#..#.#
.#..##..##..#
#.#...#....#.
...##.#....#.
...##.#....#.
#.#...#....#.
.#...#..##..#
##.#.#.#..#.#
..##.#.####.#

#......
.#.####
#.#####
.##...#
..#....
###.##.
##.####
.#..##.
.##....
##..##.
##..##.

##..#.#..#..###
##.#......#....
####....#.#####
.#.##.##.......
#..#.#..####..#
#..#.#..####..#
.#.##.##.......

.#..###.#
..#...##.
#####.#.#
....#.###
#.###.#.#
###.####.
##..#..#.
.#.#.....
.#.#.....
##..#..#.
###.####.
#.###.#.#
....#.###
#####...#
..#...##.
.#..###.#
.#..###.#

#.#.#.....###.##.
#.#.#.....###.##.
#...#.#.#####..#.
..#....#.####....
#.#.##.##..###..#
#.#....#.#.#.####
.##.#####........
.#.#.##..#####..#
.#.......#.######
..##.###.##.#####
####.#..##..#....
##..#.#.##.##.##.
#.#..#.#....##..#

#...#.####.#.#.##
#..#.#.#..##..#.#
.###...###..#....
####..###.###..##
##..##...###.##..
#.#.##.##..#.#..#
#.#.##.##.##.#..#
.##.#.##...###...
.##.#.##...###...
#.#.##.##.##.#..#
#.#.##.##..#.#..#

..........##.
.##.#.#.####.
####..###.###
####.#..#..##
.##.##.#...#.
....####...#.
.##...###..##
####.###.#.##
....###.#...#
#..#.##....#.
#..#.##.#..#.

.###...#.....
.###...#.....
..####.#####.
...#.##.##.##
#.###...###..
####.#.#.###.
#.#.#.##...##
#.#.#.##...##
####.###.###.
#.###...###..
...#.##.##.##
..####.#####.
.###...#.....

.###..#.#
.#.#..#.#
.#.###..#
##....###
##....###
.#.###..#
.#.#..#.#
.###..#.#
..###.#.#
.##.#.#.#
####..###
###..##.#
#.#.###.#
###..####
#.#.#.#.#
......#..
#..#####.

#...#..#..###..##
.#.##.#.##.......
.##.#.#...#......
#..#.#...###.##.#
#.#...###.#######
####.##..#...##..
##..#.####.######
..#.#..#.####..##
...######.###..##
####....###......
.#####.#.##..##..
.##..#..#........
####...###...##..

###.##..#
###.##..#
###.####.
##..#####
#....#..#
#..##.##.
..#..####

####......#######
####..##..#######
.##.#.##.#.##..##
###...##...######
..##..##..##.....
.#..#....#..#..#.
####..##..#######
#..###..###..##..
.####.##.####..##
.#..........#..#.
#..#..##..#..##..

....#..#..#..#..#
....#..#..#..#..#
#.#.#.###.#..#.##
..#..###...##...#
.#......##....##.
##..#...#.#..#.#.
#.#######.##.#.##
##...##.#..##..#.
####..#..######..
.##..#..##.##.##.
...#...#..####..#
#####.###......##
.#####.#.######.#
.#.....#.#.##.#.#
.###.......##....
.#...#....#..#...
.#.#..##..#..#..#

###...###
..#.#.#..
#.#...#.#
###.#.#.#
...##.#..
####..#.#
..#..#..#
###....#.
....#.#..
....#.#..
###....#.

..#..###.##
##.##.###..
..##....##.
..##..##.##
##..##.####
#####.#....
##.#....###

.#.#.##.#..
#....#.##..
#.#.###.###
#.##.###.##
.#.##...###
#..........
...##....##
#...#......
###.#.#....
###.#.#....
#...#......
.#.##....##
#..........
.#.##...###
#.##.###.##

..####...#.####.#
#......##..#..#..
#.#..#.#####..###
##....#####.##.##
..####......##..#
..#..#..#.#.##.#.
#..##..##.######.
..####..###....##
###..#######..###
.#.##.#.#..#..#..
.######.##.#..#.#

..##..###..
..#####....
...#.#.#.##
...#.#.####
..#####....
..##..###..
##......##.
##.#..#.###
###..##....
...##..##.#
##.###.#.#.
###.#.#....
..##...#..#
####.###.##
....#..#.##

#....##....
..##....##.
#.##....##.
.#...##...#
#..........
#####..####
#....##....

..#..#.
##.#.##
#..#...
#...##.
...#...
...#...
#...##.
#..#...
##.#.##
..#..#.
....#..
#.#..##
##....#
...#...
...##..

.####.####.
.###.......
..#####..##
...#.##..#.
#.#.###..##
.#..##....#
..#....##..
#.#.#.#..#.
#.#.#.#..#.

...#..####....#..
....#.###...##...
###....#...#.#...
...###...##....##
##.##..#..###.#..
#..#.#...#.#...##
..#....#...#..#..
..#....#...#..#..
#....#...#.#...##
##.##..#..###.#..
...###...##....##
###....#...#.#...
....#.###...##...
...#..####....#..
....#..###.#..###
#.....###....##..
....####....##...

#.#.#.#..#.#...#.
#..#.#.#..#...###
##.#..#.#.....#.#
###..#..#..#...##
##..#....#...#.#.
.##.#....#...##..
.##......#...##..
##..#....#...#.#.
###..#..#..#...##
##.#..#.#.....#.#
#..#.#.#..#...###
#.#.#.#..#.#...#.
.####...#..##.#..
####.##.#####.##.
.####.#####..#.#.
#...###.......###
#...###.......###

.#.##.#..##...#
###..###.##.#..
#.####.##..#.##
#.#..#......#..
#.#..#......#..
#.####.##..#.##
###..###.##.#..

...#.##.##.##.#..
##....######....#
##..#.##..##.#..#
###.#.######.#.##
..#...#.##.#...#.
...#.#.####.#.#..
..###.##..##.###.
....#...##...#...
..#..##....##..#.
.#.#.#..##..#.#.#
##....#.##.#....#
##.#####..#####.#
##....#....#....#
...###.####.###..
..#####....#####.
##...#.####.#...#
########..#######

####.##...##.##.#
#..##.######..#..
#..##.######.##..
..#.#..##########
.#.#..#.###.##.##
#.#.#..##...###.#
#....#..#.#.#....
#....#..#.#.#....
#.#.#..##...###.#
.#.#..#.###.##.##
..#.#..##########
#..##.######.##..
#..##.######..#..

##.#..#
######.
.#..#..
.....##
.....##
.#..#..
######.
##.#..#
.###.#.
..#.##.
....##.
.###.#.
##.#..#

##....###.#..##..
.#...##.##.##..##
#...##.###..#..#.
#..####...#######
#..####.#.#######
#...##.###..#..#.
.#...##.##.##..##
##....###.#..##..
###.#.###..#....#
#...##.#..#..##..
......#..#..#..#.
.#.....##...#..#.
..#...##.##......

.####.#
...#.##
#...###
#.##...
.##....
....#..
.#..#..
.....##
.##..##
#...###
#...###

##.#.##
#..#.#.
#.#..##
#.##.##
##..#..
..#.###
.#.####
.#..###
.#..###

#.##..###.#
...####.##.
.#.###.###.
#.....###..
..####.####
....#..#.##
....#..#.##
..####.####
#.....###..
.#.###.###.
...####.##.
#.##..###.#
#.##..###.#
...####.##.
.#.###.###.
#......##..
..####.####

.###...#...##
..##.#...#..#
....#.##.####
..#....###.#.
..###.##.####
..####..#...#
..##..#...#..
.......##..##
...#.#.####..
###.#.##.##..
..#.###.#.#.#
####.....#.##
###...#####.#
...#####.####
##.#.#####.##
##.#.#####.##
...#####.####

#..###.#..##.
.....#.....##
####....####.
....#.....###
#####.##.#.#.
.##..#####.##
.....##..####
#######..#.##
.##..##..#...
#####.#..###.
#..#.###..###
#..#.###..###
#####.##.###.
.##..##..#...
#######..#.##

..#..##.....#
###.#.##.###.
#.###.#######
####.#..#....
####.#..#....
#.###.#######
###.#.##.###.
..#..##.....#
#.######..##.
.#.##....##..
##.#.....##..
##.#.....##..
.#.##....##..
#.######..###
..#..##.....#

........####...#.
........####...#.
#...######.##.##.
.####.##.#...##.#
##..###.#......##
#....##.###.#....
#######....#.#.##
.####.#..#.###..#
.####.##...#.##.#

#####.#.#
#..##.##.
.....#...
#####..#.
.##.....#
....#.###
....#.###
.##.....#
#####..#.
.....#...
#..##.##.
#####.#.#
.##..#...
..#...#..
.##.##..#
....##...
####...#.

###....
#.###.#
###...#
.#.#.##
###.###
###.###
.#.#.##
###...#
#.###.#
###....
.#####.
#..#...
.####.#
.####.#
#..#..#
.#####.
###....

......#..####..#.
##..##.#.####.#.#
..##...##....##..
......#..####..#.
#.##.##..#..#..##
##..##.#.####.#.#
.........#####...
.#..#..###..###..
#....###..##..###
#######........##
#########....####
########..##..###
.......##.##.##..
######.##....##.#
......###....###.
......#..####..#.
##..##.#..##..#.#

..#..####..#.
..#..#..#..#.
##.##....##.#
...########..
###..###...##
##.##....##.#
..#..####..#.
##....##....#
..##########.
##.########.#
...##.##.##..

..####..####..##.
.###.####.###.##.
##.##....##.##..#
.####....####....
#.#.#.##.#.#..##.
#####.##.########
#...#....#...#..#

..##..#.##.##.##.
..##..###########
#....#..##.##.##.
.####.##.##..##.#
##..##..########.
######.##..##..##
#....##..#.##.#..
#....###..#..#..#
.....##.##....##.

.....#...##..####
.....#...#...####
.....#...#...####
.....#...##..####
.#..####...#...#.
#########.##..###
#####.##...##.#.#
..#.#.##.##...##.
....###..##.##.##
#.###..##.#..##.#
.....########..##
##..###.##..#####
.####.#.#..#...##
##..#..#.###.#.#.
#.##...##.#.....#
.#.#.....#.......
#...#####.######.

#......###.##.#
.##.##.#.#.##.#
######...######
.###.###..####.
###..####..##..
###..####..##..
.###.###..####.
######...######
.##.##...#.##.#
#......###.##.#
#.#####..##..##

#.##.#.#...
..##..##...
#.##.#.####
.#####.....
#....##..##
..##.......
.####......
#....#.#.##
##..###.#..
.####.#.###
..##..#....
#....#.....
.####.###..

#..###..#.####..#
#####.##..##..##.
####.#.##....##.#
####....#....#...
.##...#..####..#.
#####..#......#..
#..#.....####....

#####.#..##.##.
........#......
......##.###...
#####....#..#.#
.##....#######.
####.#..#.##...
.##.#.######.##
....#....###..#
#..#####....##.
.##.##..######.
......#.#.##.#.
####..#..####..
.##...#..##..##
#..##.#.###.#.#
#..###..#..#.##
.##.#..##..#.#.
.##.#...#..#.#.

.#.#..#.#.##.#.
##########..###
####..####..###
.###..###.##.##
##############.
#.##..##.####.#
##..##..######.

##..#.####.#.
....#.#..#.#.
....#.#..#.#.
##..#.####.#.
.##.#..##..#.
.#.#.#.##.#.#
#.#.#......#.
#..######.###
..#.##....##.
.#.####..####
....#..##..#.

....#####....
#######.####.
.#####.##..##
#.##.#..#..#.
#.###.#..####
..#...##.####
.#.#..#.#####
.#.#..#.#####
..#...##.####
#.###....####
#.##.#..#..#.
.#####.##..##
#######.####.
....#####....
....#####....

.......##
.##..##..
.##..##..
.......##
#....##.#
#..##.#.#
#####...#
####..###
....#.#..
#..#..#.#
........#
#####.###
....#..#.

#...##.
#....##
#####..
#.###.#
.###..#
.#.#..#
#.###.#
#####..
#....##
#...##.
#...##.

#.......####..###
.#.#..#.#........
##.#..#.####..###
...####...#....#.
#.#....#.#......#
#...##...#..##..#
##.####.##......#
###....###..##..#
.########.##..##.

#..#...####
#..##.#####
#..##.#..#.
#..##.#..#.
#..##.#####
#..#...####
##########.
.....#..#..
#..#.#.#.##
#...#.#.##.
#..#.#.###.
....####...
.....#.#..#
.....##.##.
.##.##.##.#
.....######
.##.#..##..

##.#....#..#.#.
####.##.#...##.
..##..###.##.##
........##..##.
...###.#..#...#
..#.##..#.#####
..####..##.####
...#...##.#.#..
..###.###.#....
##...##.#.#....
###..#.###...##
#####..####.##.
...#...##.#.###
..#....########
...#.#######.##
..##.#.#...##..
..##.#.#...#...

..#.##.#...
.#.#.......
########.##
..#..###..#
....#..###.
....#..###.
..#..###..#
#######..##
.#.#.......
..#.##.#...
.#.#.#.#.##
.#...#.#.#.
#####.#.##.
##...###..#
##...###..#

.#.....###.#.....
#.###...#.#......
...#...##....#..#
...#...##....#..#
#.###...#.#......
.#......##.#.....
#.#..########....
..##.##.#####.##.
#...##.#.##.#.##.
#....#..#....#..#
.#.###.##...#####
...##..#.........
.#..####.##.#....
......#.##...####
#..#######..#.##.

..##...#.#..#.#
...#.#.#......#
.##..###......#
.##..##.#....#.
#.#...##..##..#
#..#..###.##.##
#.##..#.##..##.
####..##......#
#.###.##.####.#
####.#..#....#.
.####..#......#
...##.##.####.#
#.####.#..##..#
.##.####..##..#
..#.####..##..#

.##..###..#.....#
.##.###.....#.##.
.##.###.....#.##.
.##..#.#..#.....#
.##......###..#.#
#..#.###.###..##.
......####.####.#
#..#.####..#..#..
.##.....##.##.###

....##...
##.####.#
##..##..#
##.####.#
##......#
####..##.
###.##.##
##......#
###....##
...#..#..
##..##..#
...#..#..
..######.
###....##
##.####.#
...####..
..######.

.#....#..
.##..##..
.######..
#.#..#.##
#...#..##
#.####.##
#..##..##
.##..##..
.#.##.#..
.#....#..
.##..##..
#.#..#.##
##....###
###..####
.#....#..

.....#.##.#
........#.#
...###..###
#.#.###.#.#
...#.#....#
..#.##.###.
..###....#.
###.##.###.
###.##.###.

..###.#..#.###...
..###......###...
#....#....#....##
.#..#.####.#..#..
#.##..#..#..##.##
...#.######.#..##
....##....##.....
...##########....
##..###..###..###
#.#.#......#.#.##
.#.##########.#..
#..###....###..##
..#....##....#...

.#....##.##..##.#
.#.####.#..##..#.
.#.##..#........#
..##.###..#..#..#
..#...###.#..#.##
#..#...##.####.##
#.#...#.###...##.
##.##..###.##.###
...#.##..........
...#.##..........
##.##..###.##.###

.###.##.###.#..##
..#.#..#.#...##.#
....#..#.....#.#.
..##....##..#.#.#
..##....##..#.#.#
....#..#.....#.#.
..#.#..#.#...##.#
.###.##.###.##.##
#....##....#####.
.##......##.#.##.
.##......##..###.
.##.#..#.##.###.#
#####..#####.####
...######...#.#.#
#..##..##..##.###

.....#.....
..#.#.#####
###..##....
##..#.#.##.
..######..#
...#..#....
#####..####
##.#....##.
...#..##..#
####.#..##.
##..##.....
...##.##..#
..###..#..#
#####...##.
......##..#
###...##..#
....#.##.##

..####.#.#....###
##...##..###.##.#
###.##.#..#....#.
###.##.#..#....#.
##...##..###.##.#
..####.#.#..#.###
.......######.#..
..#.##.....#.....
..#.##.##.#.####.

##..#.#.###.#
##..#.#.###.#
#.#..###..##.
...#.#...##.#
###.#.##..#.#
.#..####.#.##
.#####.##..#.
.######.#####
#..........#.
#..........#.
.######.#####
.#####.##..#.
.#..####.#.##
###.#.##.##.#
...#.#...##.#

...##.##.#.####
.#.#...#..#.##.
.#..#..####....
#####.#.#.##..#
.....###.#.#..#
......##.#.#..#
#####.#.#.##..#

#....######..##
#####.....#.#..
..##..#.#..#.##
..##..##..###..
..##.....##.###
#....###.###.##
##..##.#.#.##..

##..##.###..###
##..##.###..###
......#.####..#
..##.###.#.####
#....###...#.##
##..####..#.#..
.####.#.....#.#

###.####.##.#
........#..#.
..####.......
##....##....#
#.#..#.#.##.#
##.##.###..##
##.##.##....#
#.####.#....#
.#.##.#..##..

####....#.#..###.
.##.#..##...#..##
.##.#..##...#..##
####....#.#..###.
#####.#.#.##.....
..#.....#....###.
#..#.#...##.#..##
#..#####.##...#.#
######.#...#.#...

.#..#.#...#..
##..##.####..
..##...#..#..
.#..#...#..#.
.####....##..
#....##..####
.####.#.###..
......#.##.##
..##..#...#..
#....#.####..
..##....#####

#...#.#..##.#
#...#.#..##.#
###..##......
#########...#
.#..#.#.##...
#..####...#..
#..##..#..##.
#....##.....#
#....##.....#
#..##..#..##.
#..####...#..
.#..#...##...
#########...#
###..##......
#...#.#..##.#

#.#...#
...####
#.#.#..
####...
#....##
##.##..
##.##..

.##......##..
#..#.....##..
....##...##..
#..#.#...##..
#..##.#.####.
#..#.#...##..
.##...#..##..
#..###.##..##
....##.#....#
....#.....#..
#..#.##.####.
######...##..
####..#.#..#.
....#####..##
.##.#.##....#
#..##.#......
#..#.###....#

...#....#....#.
#.#......#.#..#
.#...##...#.#..
#.###..###.#...
#.#......#.##.#
##...##...#..#.
.#..#..#..#....
#..........#.#.
.#.#.##.#.#.#..
.#.#.##.#.#.#..
#..........#.#.

##.####.##.####.#
..#.##.####.##.#.
.#.####.##.####.#
#..#..#....#..#..
#..#..#....#..#..
##.#..#.##.#..#.#
#.##..##..##..##.
####..######..###
###.##.####.##.##
....##......##...
#.##..##..##..##.
#...##......##...
#.##..##..##..##.

#....#####.##..##
......#..##.#####
########.#.###.##
#.##.###.......##
..##...##..##....
......####.#.####
.......#..###....
####.#.#.###...##
###########..#...
.........#...#.##
......#.#....#...

.##.##.#.
#.#.##.##
#.......#
#.......#
#.#.##.##
.##.##.#.
.###..###
#..#..##.
.#.####..
####.....
#....#...
....#...#
.####.###
.#...#...
#.#######
#...#..##
#.#.#..##

.##.#####..
..#.#.##...
###.###.#..
###.##...#.
.#.#...##..
...#...#.#.
##.###....#
##.##.....#
...#...#.#.
.#.#...##..
###.##...#.
###.###.#..
..#.#.##...
.##.#####..
..#......##
##.#.#####.
##.#.#####.'''

run_tests()
